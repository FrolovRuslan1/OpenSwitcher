#!/bin/bash

my_dir="$(dirname "$0")"
source "$my_dir/../include/header.sh"

if [ ! -f "$sudoerspath" ]; then
	echo "Добавляется правило для корректной работы OPenSwitcher в $sudoerspath:"
	echo ""
	echo "$rule"
	sudo touch $sudoerspath
	echo "$rule" | sudo tee $sudoerspath > /dev/null

	if ! sudo grep -q "$rule" "$sudoerspath"; then
		echo "Правило не добалено, завершение установки"
		exit 1
	else
		echo "Правило добалено"
	fi
	
else

	if ! sudo grep -q "$rule" "$sudoerspath"; then
		echo "Правило не добалено, попытка добавления правила"
		echo "$rule" | sudo tee $sudoerspath

		if ! sudo grep -q "$rule" "$sudoerspath"; then
			echo "Правило не добалено, завершение установки"
			exit 1
		else
			echo "Правило добалено"
		fi
	else
		echo "Правило добалено"
	fi
	
fi

echo "Установка завершена."