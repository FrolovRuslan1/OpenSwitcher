#!/bin/bash
my_dir="$(dirname "$0")"
source "$my_dir/../include/header.sh"

add_standart_combination() 
{
    if [ "$1" -eq 1 ]; then
        if ! grep -q "$defaultCombination" "$file"; then
			echo "Добавляется стандартная комбинация клавиш для запуска"
			echo "
$defaultCombination
			" | sudo tee -a "$HOME/.xbindkeysrc"
			echo "Установите необходимую вам конфигурацию запуска"
        else
            echo "Стандартная комбинация клавиш найдена"
        fi
    else
		echo "Установка стандартного файла $file"
		xbindkeys --defaults > "$file"
		echo "Добавляется стандартная комбинация клавиш для запуска"
		echo "
$defaultCombination
			" >> "$HOME/.xbindkeysrc"
		echo "Установите необходимую вам конфигурацию запуска"
    fi
    
}

add_standart_autostart()
{   
    if [ "$1" -eq 1 ]; then
        if ! grep -q "exec xbindkeys&" "$file"; then
			echo "exec xbindkeys&" >> "$HOME"/.xinitrc
        else
            echo "Стандартный автостарт найден"
        fi
    else
		cp /etc/X11/xinit/xinitrc "$HOME"/.xinitrc
		echo "exec xbindkeys&" >> "$HOME"/.xinitrc
    fi
    
}

# Check requested files
for file in "${required_files[@]}"; do
    if [ ! -f "$file" ]; then
        echo "Файл $file не найден."

        if [ "$file" = "$HOME/.xbindkeysrc" ]; then
            add_standart_combination 0
        elif [ "$file" = "$HOME/.xinitrc" ]; then
            add_standart_autostart 0
        fi
    else
        echo "Файл $file найден."

        if [ "$file" = "$HOME/.xbindkeysrc" ]; then
            add_standart_combination 1
        elif [ "$file" = "$HOME/.xinitrc" ]; then
            add_standart_autostart 1
        fi
       
    fi
done

echo "Проверка завершена."